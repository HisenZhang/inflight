<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <title>InFlight</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css?v=8">
    <link rel="manifest" href="manifest.json">
</head>
<body>
    <div class="container">
        <header>
            <!-- Tab Navigation -->
            <div class="tab-navigation">
                <button class="tab-btn active" data-tab="data">DATA</button>
                <button class="tab-btn" data-tab="route">ROUTE</button>
                <button class="tab-btn" data-tab="navlog">NAVLOG</button>
                <button class="tab-btn" data-tab="map">MAP</button>
                <button class="tab-btn" data-tab="chklst">CHKLST</button>
                <button class="tab-btn" data-tab="stats">STATS</button>
            </div>
        </header>

        <!-- Tab: Data & Cache -->
        <div class="tab-content active" id="tab-data">
            <!-- Database Section -->
            <div class="data-section">
                <h3 class="section-header">DATABASE</h3>

                <div class="check-item" id="databaseCheck">
                    <span class="check-label">STATUS</span>
                    <span class="check-status" id="databaseStatus">NOT LOADED</span>
                </div>

                <div id="dataInfo" class="data-info"></div>

                <div class="data-actions">
                    <button id="loadDataBtn" class="btn btn-primary font-bold">LOAD DATABASE</button>
                    <button id="reindexCacheBtn" class="btn btn-secondary" style="display: none;">REINDEX</button>
                    <button id="clearDataBtn" class="btn btn-warning" style="display: none;">CLEAR ALL</button>
                </div>

                <p class="help-text">
                    <span class="text-secondary">FAA NASR (US) + OurAirports (Worldwide)</span>
                </p>
            </div>

            <!-- Advanced Details Section (Collapsible) -->
            <div id="dataInspection" class="data-section" style="display: none;">
                <h3 class="section-header">ADVANCED</h3>
                <div id="inspectionContent" class="inspection-content"></div>
            </div>

            <!-- Flight Tracks Section -->
            <div class="data-section">
                <h3 class="section-header">FLIGHT TRACKS</h3>
                <div id="flightTracksList" class="flight-tracks-list"></div>
                <div class="data-actions">
                    <button id="refreshTracksBtn" class="btn btn-secondary">REFRESH</button>
                    <button id="clearAllTracksBtn" class="btn btn-warning" style="display: none;">CLEAR ALL TRACKS</button>
                </div>
            </div>
        </div>
        <!-- End Tab: Data & Cache -->

        <!-- Tab: Route -->
        <div class="tab-content" id="tab-route">
        <!-- Input Section -->
        <div class="input-section">
            <h2 class="font-bold text-primary">ROUTE ENTRY</h2>

            <!-- ICAO-Style Route Input (Required) -->
            <div class="route-input-icao">
                <!-- Departure Airport -->
                <div class="input-group">
                    <label class="text-sm font-medium text-secondary">DEPARTURE:</label>
                    <div class="input-wrapper">
                        <input
                            type="text"
                            id="departureInput"
                            class="font-medium route-field"
                            placeholder="KALB"
                            maxlength="6"
                            autocomplete="off"
                            disabled
                        >
                        <div id="departureAutocompleteDropdown" class="autocomplete-dropdown"></div>
                    </div>
                </div>

                <!-- Route (Optional) -->
                <div class="input-group">
                    <label class="text-sm font-medium text-secondary">ROUTE:</label>
                    <div class="input-wrapper">
                        <input
                            type="text"
                            id="routeInput"
                            class="font-medium route-field"
                            placeholder="PAYGE Q822 FNT WYNDE3 (or leave blank for DCT)"
                            autocomplete="off"
                            disabled
                        >
                        <div id="autocompleteDropdown" class="autocomplete-dropdown"></div>
                    </div>
                </div>

                <!-- Destination Airport -->
                <div class="input-group">
                    <label class="text-sm font-medium text-secondary">DESTINATION:</label>
                    <div class="input-wrapper">
                        <input
                            type="text"
                            id="destinationInput"
                            class="font-medium route-field"
                            placeholder="KORD"
                            maxlength="6"
                            autocomplete="off"
                            disabled
                        >
                        <div id="destinationAutocompleteDropdown" class="autocomplete-dropdown"></div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="button-row">
                    <button id="calculateBtn" class="btn btn-primary font-bold" disabled>CALCULATE</button>
                    <button id="clearRouteBtn" class="btn btn-secondary">CLEAR</button>
                </div>
            </div>
            <p class="help-text mb-md">
                Airports (ICAO), NavAids, Fixes, Airways, SID/STAR. Route is optional - leave blank for direct (DCT).
            </p>

            <!-- Optional Features -->
            <div class="optional-features">
                <p class="text-secondary text-sm mb-sm">OPTIONAL FEATURES:</p>

                <!-- Wind Correction & Time Estimation -->
                <div class="feature-toggle">
                    <div class="checkbox-toggle" id="enableWindsToggle"></div>
                    <label class="font-medium" style="cursor: pointer;">WIND CORRECTION & TIME</label>
                    <span class="help-text-inline">- winds aloft, WCA, ground speed, ETA</span>
                </div>
                <div id="windInputs" class="feature-inputs hidden">
                    <div class="input-row">
                        <label class="text-sm font-medium">CRUISE ALTITUDE (FT MSL):</label>
                        <input
                            type="number"
                            id="altitudeInput"
                            class="font-medium"
                            placeholder="e.g. 5500"
                            min="0"
                            max="45000"
                            step="100"
                            value="5500"
                            disabled
                        >
                    </div>
                    <div class="input-row">
                        <label class="text-sm font-medium">TRUE AIRSPEED (KT):</label>
                        <input
                            type="number"
                            id="tasInput"
                            class="font-medium"
                            placeholder="e.g. 120"
                            min="0"
                            max="500"
                            step="5"
                            disabled
                        >
                    </div>
                    <div class="input-row">
                        <label class="text-sm font-medium">FORECAST PERIOD:</label>
                        <div class="radio-group">
                            <div class="radio-btn selected" data-period="06">6 HR</div>
                            <div class="radio-btn" data-period="12">12 HR</div>
                            <div class="radio-btn" data-period="24">24 HR</div>
                        </div>
                    </div>
                    <p class="help-text mt-sm">
                        <span class="text-warning">⚠</span> Wind data requires internet access
                    </p>
                </div>

                <!-- Fuel Planning -->
                <div class="feature-toggle">
                    <div class="checkbox-toggle" id="enableFuelToggle"></div>
                    <label class="font-medium" style="cursor: pointer;">FUEL PLANNING</label>
                    <span class="help-text-inline">- calculate fuel burn and reserves</span>
                </div>
                <div id="fuelInputs" class="feature-inputs hidden">
                    <div class="input-row">
                        <label class="text-sm font-medium">USABLE FUEL (GAL):</label>
                        <input
                            type="number"
                            id="usableFuelInput"
                            class="font-medium"
                            placeholder="e.g. 32"
                            min="0"
                            max="500"
                            step="1"
                            value="32"
                            disabled
                        >
                    </div>
                    <div class="input-row">
                        <label class="text-sm font-medium">TAXI FUEL (GAL):</label>
                        <input
                            type="number"
                            id="taxiFuelInput"
                            class="font-medium"
                            placeholder="e.g. 1"
                            min="0"
                            max="10"
                            step="0.1"
                            value="1"
                            disabled
                        >
                    </div>
                    <div class="input-row">
                        <label class="text-sm font-medium">BURN RATE (GAL/HR):</label>
                        <input
                            type="number"
                            id="burnRateInput"
                            class="font-medium"
                            placeholder="e.g. 10"
                            min="0"
                            max="50"
                            step="0.5"
                            value="10"
                            disabled
                        >
                    </div>
                    <div class="input-row">
                        <label class="text-sm font-medium">FUEL RESERVE:</label>
                        <div class="radio-group">
                            <div class="radio-btn selected" data-reserve="30">VFR DAY (30 MIN)</div>
                            <div class="radio-btn" data-reserve="45">VFR NIGHT / IFR (45 MIN)</div>
                        </div>
                    </div>
                    <p class="help-text mt-sm">
                        Requires WIND CORRECTION & TIME to be enabled
                    </p>
                </div>
            </div>

            <!-- Query History -->
            <div id="queryHistory" class="query-history" style="display: none;">
                <div class="history-label font-medium">RECENT ROUTES:</div>
                <div id="historyList" class="history-list"></div>
            </div>
        </div>
        </div>
        <!-- End Tab: Route -->

        <!-- Tab: Navlog -->
        <div class="tab-content" id="tab-navlog">
        <!-- Results Section -->
        <div id="resultsSection" class="results-section" style="display: none;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                <h2 class="font-bold text-primary">NAVIGATION LOG</h2>
                <div class="navlog-actions">
                    <button id="exportNavlogBtn" class="btn btn-secondary btn-sm">EXPORT</button>
                    <button id="importNavlogBtn" class="btn btn-secondary btn-sm">IMPORT</button>
                    <input type="file" id="importNavlogInput" accept=".json" style="display: none;">
                </div>
            </div>
            <div id="routeSummary" class="route-summary"></div>

            <!-- Wind Altitude Table (shown when wind correction enabled) -->
            <div id="windAltitudeTable" class="wind-altitude-table" style="display: none;"></div>

            <div id="navlogTable" class="navlog-table"></div>
        </div>
        </div>
        <!-- End Tab: Navlog -->

        <!-- Tab: Vector Map -->
        <div class="tab-content" id="tab-map">
        <!-- Vector Map Display -->
        <div id="tacticalDisplay" class="tactical-display" style="display: none;">
            <div class="tactical-header">
                <div class="zoom-controls">
                    <button class="zoom-btn active" data-zoom="full">ROUTE</button>
                    <button class="zoom-btn" data-zoom="destination">DEST</button>
                    <button class="zoom-btn" data-zoom="surrounding-50">50NM</button>
                    <button class="zoom-btn" data-zoom="surrounding-25">25NM</button>
                    <button class="zoom-btn" id="zoomOutBtn">−</button>
                    <button class="zoom-btn" id="zoomInBtn">+</button>
                </div>
            </div>

            <div id="tacticalMap" class="tactical-map"></div>

            <!-- Map Info Status Bar -->
            <div id="mapStatusBar" class="map-status-bar hidden">
                <table class="navlog-table" style="width: 100%; margin: 0;">
                    <tbody id="statusBarContent"></tbody>
                </table>
            </div>

            <!-- Navigation Panel -->
            <div id="navigationPanel" class="navigation-panel">
                <div id="navigationContent" class="navigation-content">
                    <!-- Primary row: WPT, HDG, DIST, ETE -->
                    <div class="nav-primary-row">
                        <div class="nav-item">
                            <span class="nav-label">WPT</span>
                            <span class="nav-value next-wp"></span>
                        </div>
                        <div class="nav-item">
                            <span class="nav-label">HDG</span>
                            <span class="nav-value req-hdg"></span>
                        </div>
                        <div class="nav-item">
                            <span class="nav-label">DIST</span>
                            <span class="nav-value dist-nm"></span>
                        </div>
                        <div class="nav-item">
                            <span class="nav-label">ETE</span>
                            <span class="nav-value ete-value"></span>
                        </div>
                    </div>

                    <!-- Secondary row: GS, ETA, H-ACC, V-ACC -->
                    <div class="nav-secondary-row">
                        <div class="nav-item">
                            <span class="nav-label">GS</span>
                            <span class="nav-value gs-value"></span>
                        </div>
                        <div class="nav-item">
                            <span class="nav-label">ETA</span>
                            <span class="nav-value eta-time"></span>
                        </div>
                        <div class="nav-item">
                            <span class="nav-label">H-ACC</span>
                            <span class="nav-value gps-horiz-acc text-secondary">--</span>
                        </div>
                        <div class="nav-item">
                            <span class="nav-label">V-ACC</span>
                            <span class="nav-value gps-vert-acc text-secondary">--</span>
                        </div>
                    </div>

                    <!-- Navigation buttons -->
                    <div class="nav-buttons-row">
                        <button class="btn btn-secondary" id="prevNavWptBtn">◄ PREV</button>
                        <button class="btn btn-secondary" id="nextNavWptBtn">NEXT ►</button>
                    </div>
                </div>
            </div>
        </div>
        </div>
        <!-- End Tab: Map -->

        <!-- Tab: Checklist -->
        <div class="tab-content" id="tab-chklst">
            <div class="checklist-section">
                <h2 class="font-bold text-primary">PIPER CHEROKEE 140 CHECKLIST</h2>

                <!-- Before Start -->
                <div class="checklist-card" data-section="0">
                    <h3 class="checklist-title checklist-title-collapsible">
                        <span>BEFORE START</span>
                        <span class="checklist-chevron">▼</span>
                    </h3>
                    <div class="checklist-items">
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Passenger / crew briefing - COMPLETE</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Fuel selector - DESIRED TANK</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Mixture - FULL RICH</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Throttle - OPEN 1/4"</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Carb heat - OFF</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Avionics - OFF</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Beacon - ON</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Circuit breakers - IN</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Parking brake - SET</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Seatbelts - FASTENED</span>
                        </div>
                    </div>
                </div>

                <!-- Engine Start -->
                <div class="checklist-card collapsed" data-section="1">
                    <h3 class="checklist-title checklist-title-collapsible">
                        <span>ENGINE START</span>
                        <span class="checklist-chevron">►</span>
                    </h3>
                    <div class="checklist-items" style="display: none;">
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Master switch - ON</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Fuel pump - ON</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Prime - AS REQUIRED</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Prop area - CLEAR</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Starter - ENGAGE</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Throttle - 1000 RPM</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Oil pressure - CHECK</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Fuel pump - OFF</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Engine instruments - CHECK</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Mixture - AS REQUIRED</span>
                        </div>
                    </div>
                </div>

                <!-- Before Taxi -->
                <div class="checklist-card collapsed" data-section="2">
                    <h3 class="checklist-title checklist-title-collapsible">
                        <span>BEFORE TAXI</span>
                        <span class="checklist-chevron">►</span>
                    </h3>
                    <div class="checklist-items" style="display: none;">
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Avionics / radios - ON / SET</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Instruments - CHECKED / SET</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Lights - AS REQUIRED</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Parking brake - RELEASE</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Brakes - TEST</span>
                        </div>
                    </div>
                </div>

                <!-- Run-up -->
                <div class="checklist-card collapsed" data-section="3">
                    <h3 class="checklist-title checklist-title-collapsible">
                        <span>RUN-UP</span>
                        <span class="checklist-chevron">►</span>
                    </h3>
                    <div class="checklist-items" style="display: none;">
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Parking brake - SET</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Flight controls - FREE / CORRECT</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Fuel selector - OPPOSITE TANK</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Mixture - FULL RICH</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Throttle - 2000 RPM</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Magnetos (125 / 50) - CHECK</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Carb heat - TEST</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Engine instruments - CHECK</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Annunciator lights - CHECK</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Ammeter - CHECK</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Throttle - IDLE</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Carb heat - TEST</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Throttle - 1000 RPM</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Mixture - AS REQUIRED</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Parking brake - AS REQUIRED</span>
                        </div>
                    </div>
                </div>

                <!-- Before Takeoff -->
                <div class="checklist-card collapsed" data-section="4">
                    <h3 class="checklist-title checklist-title-collapsible">
                        <span>BEFORE TAKEOFF</span>
                        <span class="checklist-chevron">►</span>
                    </h3>
                    <div class="checklist-items" style="display: none;">
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Briefing - COMPLETE</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Seatbelts - FASTENED</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Cabin doors - CLOSED / LOCKED</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Elevator trim - SET</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Flaps - AS REQUIRED</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Instruments / radios - SET</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Fuel pump - ON</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Lights - ON</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Pitot heat - AS REQUIRED</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Mixture - FULL RICH</span>
                        </div>
                    </div>
                </div>

                <!-- Climb -->
                <div class="checklist-card collapsed" data-section="5">
                    <h3 class="checklist-title checklist-title-collapsible">
                        <span>CLIMB</span>
                        <span class="checklist-chevron">►</span>
                    </h3>
                    <div class="checklist-items" style="display: none;">
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Flaps - RETRACT</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Climb power - SET</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Mixture - AS REQUIRED</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Fuel pump - OFF</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Landing light - OFF</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Engine instruments - CHECK</span>
                        </div>
                    </div>
                </div>

                <!-- Cruise -->
                <div class="checklist-card collapsed" data-section="6">
                    <h3 class="checklist-title checklist-title-collapsible">
                        <span>CRUISE</span>
                        <span class="checklist-chevron">►</span>
                    </h3>
                    <div class="checklist-items" style="display: none;">
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Cruise power - SET</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Elevator trim - SET</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Mixture - LEAN</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Engine instruments - MONITOR</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Fuel quantity - MONITOR</span>
                        </div>
                    </div>
                </div>

                <!-- Descent -->
                <div class="checklist-card collapsed" data-section="7">
                    <h3 class="checklist-title checklist-title-collapsible">
                        <span>DESCENT</span>
                        <span class="checklist-chevron">►</span>
                    </h3>
                    <div class="checklist-items" style="display: none;">
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Briefing - COMPLETE</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Seatbelts - FASTENED</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Fuel selector - DESIRED TANK</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Fuel pump - ON</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Lights - ON</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Pitot heat - AS REQUIRED</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Carb heat - AS REQUIRED</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Mixture - FULL RICH</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Instruments - SET</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Brakes - TEST</span>
                        </div>
                    </div>
                </div>

                <!-- After Landing -->
                <div class="checklist-card collapsed" data-section="8">
                    <h3 class="checklist-title checklist-title-collapsible">
                        <span>AFTER LANDING</span>
                        <span class="checklist-chevron">►</span>
                    </h3>
                    <div class="checklist-items" style="display: none;">
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Fuel pump - OFF</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Lights - AS REQUIRED</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Pitot heat - OFF</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Carb heat - OFF</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Mixture - AS REQUIRED</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Flaps - UP</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Elevator trim - SET TAKEOFF</span>
                        </div>
                    </div>
                </div>

                <!-- Shutdown -->
                <div class="checklist-card collapsed" data-section="9">
                    <h3 class="checklist-title checklist-title-collapsible">
                        <span>SHUTDOWN</span>
                        <span class="checklist-chevron">►</span>
                    </h3>
                    <div class="checklist-items" style="display: none;">
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Parking brake - SET</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Avionics - OFF</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Throttle - 1000 RPM</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Mixture - IDLE CUTOFF</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Ignition switch - OFF</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Lights - OFF</span>
                        </div>
                        <div class="checklist-item">
                            <div class="checkbox-toggle checklist-checkbox"></div>
                            <span>Master switch - OFF</span>
                        </div>
                    </div>
                </div>

                <div class="checklist-actions">
                    <button class="btn btn-secondary" id="resetChecklistBtn">RESET ALL</button>
                </div>

                <p class="help-text mt-md text-center">
                    <span class="text-secondary">*This checklist is not intended to replace manufacturer procedures*</span>
                </p>
            </div>
        </div>
        <!-- End Tab: Checklist -->

        <!-- Tab: Stats -->
        <div class="tab-content" id="tab-stats">
            <div class="stats-section">
                <h2 class="font-bold text-primary">FLIGHT STATISTICS</h2>

                <!-- Flight Status (Most Important) -->
                <div class="stats-card">
                    <div class="stat-item-large">
                        <span class="stat-label">STATUS</span>
                        <span class="stat-value" id="flightStatus">ON GROUND</span>
                    </div>
                </div>

                <!-- System Status -->
                <div class="stats-card">
                    <h3 class="stats-card-title">SYSTEM</h3>
                    <div class="stats-grid-compact">
                        <div class="stat-item">
                            <span class="stat-label">INTERNET</span>
                            <span class="stat-value" id="internetStatus">CHECKING...</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">GPS H-ACC</span>
                            <span class="stat-value" id="gpsHorizStatus">--</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">GPS V-ACC</span>
                            <span class="stat-value" id="gpsVertStatus">--</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">GPS STATUS</span>
                            <span class="stat-value" id="gpsStatus">CHECKING...</span>
                        </div>
                    </div>
                </div>

                <!-- Fuel Statistics (Critical for safety) -->
                <div class="stats-card" id="fuelStatsCard" style="display: none;">
                    <h3 class="stats-card-title">FUEL</h3>
                    <div class="stats-grid-compact">
                        <div class="stat-item">
                            <span class="stat-label">REM</span>
                            <span class="stat-value" id="fuelRemaining">-- GAL</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">ENDUR</span>
                            <span class="stat-value" id="endurance">--:--</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">USED</span>
                            <span class="stat-value" id="fuelUsed">-- GAL</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">START</span>
                            <span class="stat-value text-secondary" id="fuelOnBoard">-- GAL</span>
                        </div>
                    </div>
                </div>

                <!-- Flight Time & Performance -->
                <div class="stats-card">
                    <h3 class="stats-card-title">FLIGHT TIME</h3>
                    <div class="stats-grid-compact">
                        <div class="stat-item">
                            <span class="stat-label">TIME</span>
                            <span class="stat-value text-metric" id="flightTime">--:--:--</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">T/O</span>
                            <span class="stat-value text-secondary" id="takeoffTime">--:--</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">AVG GS</span>
                            <span class="stat-value text-metric" id="avgGroundSpeed">-- KT</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">DIST</span>
                            <span class="stat-value text-metric" id="distanceFlown">-- NM</span>
                        </div>
                    </div>
                </div>

                <!-- GPS Track Recording -->
                <div class="stats-card">
                    <h3 class="stats-card-title">GPS TRACK</h3>
                    <div class="stats-grid-compact">
                        <div class="stat-item">
                            <span class="stat-label">MODE</span>
                            <span class="stat-value" id="trackMode">AUTO</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">REC</span>
                            <span class="stat-value" id="recordingStatus">INACTIVE</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">PTS</span>
                            <span class="stat-value" id="trackPoints">0</span>
                        </div>
                    </div>
                    <div class="stats-actions mt-sm">
                        <button class="btn btn-secondary btn-sm" id="toggleModeBtn">MANUAL</button>
                        <button class="btn btn-primary btn-sm" id="startRecBtn" style="display: none;">START</button>
                        <button class="btn btn-warning btn-sm" id="stopRecBtn" style="display: none;">STOP</button>
                    </div>
                    <div class="stats-actions mt-sm">
                        <button class="btn btn-secondary btn-sm" id="exportTrackBtn">EXPORT</button>
                        <button class="btn btn-warning btn-sm" id="clearTrackBtn">CLEAR</button>
                    </div>
                </div>

                <!-- Manual Time Entry (Logbook) -->
                <div class="stats-card">
                    <h3 class="stats-card-title">LOGBOOK TIMES</h3>
                    <div class="time-entry-grid">
                        <div class="time-entry-item">
                            <label class="stat-label">HOBBS START</label>
                            <input type="number" id="hobbsStart" class="time-input" placeholder="0.0" step="0.1" min="0">
                        </div>
                        <div class="time-entry-item">
                            <label class="stat-label">HOBBS END</label>
                            <input type="number" id="hobbsEnd" class="time-input" placeholder="0.0" step="0.1" min="0">
                        </div>
                        <div class="time-entry-item">
                            <label class="stat-label">HOBBS TOTAL</label>
                            <span class="stat-value" id="hobbsTotal">-- HR</span>
                        </div>
                    </div>
                    <div class="time-entry-grid mt-md">
                        <div class="time-entry-item">
                            <label class="stat-label">TACH START</label>
                            <input type="number" id="tachStart" class="time-input" placeholder="0.0" step="0.1" min="0">
                        </div>
                        <div class="time-entry-item">
                            <label class="stat-label">TACH END</label>
                            <input type="number" id="tachEnd" class="time-input" placeholder="0.0" step="0.1" min="0">
                        </div>
                        <div class="time-entry-item">
                            <label class="stat-label">TACH TOTAL</label>
                            <span class="stat-value" id="tachTotal">-- HR</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- End Tab: Stats -->

    </div>

    <!-- Scripts - Load modules in order (3-Engine Architecture) -->

    <!-- External Libraries -->
    <script src="lib/geodesy.js"></script>              <!-- WGS84 + WMM2025 library -->
    <script src="lib/wind-stations.js"></script>        <!-- Wind station data -->

    <!-- Utilities Layer -->
    <script src="utils/formatters.js"></script>         <!-- Shared formatting utilities -->

    <!-- Data Engine -->
    <script src="data/nasr-adapter.js"></script>        <!-- NASR data adapter (primary) -->
    <script src="data/ourairports-adapter.js"></script> <!-- OurAirports adapter (fallback) -->
    <script src="data/data-manager.js"></script>        <!-- Data loading & caching orchestrator -->

    <!-- Compute Engine -->
    <script src="compute/winds-aloft.js"></script>      <!-- Wind data fetching & interpolation -->
    <script src="compute/route-expander.js"></script>   <!-- Airway/STAR/DP expansion module -->
    <script src="compute/route-calculator.js"></script> <!-- Navigation calculations module -->
    <script src="compute/query-engine.js"></script>     <!-- Spatial queries & search -->

    <!-- State Management -->
    <script src="state/flight-state.js"></script>       <!-- Flight plan & navigation state -->
    <script src="state/flight-tracker.js"></script>     <!-- Flight time & GPS tracking -->

    <!-- Display Layer -->
    <script src="display/ui-controller.js"></script>       <!-- UI interactions module -->
    <script src="display/stats-controller.js"></script>    <!-- Stats tab controller -->
    <script src="display/checklist-controller.js"></script><!-- Checklist tab controller -->
    <script src="display/tactical-display.js"></script>    <!-- Vector map & GPS tracking -->
    <script src="display/app.js"></script>                 <!-- Main application coordinator -->
</body>
</html>
